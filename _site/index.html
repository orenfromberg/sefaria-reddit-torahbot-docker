<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>u/TorahBot</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>

<body>
    <div class="container-md">
        <div class="row">
            <div class="col"></div>
            <div class="col-md-auto">
                <h1>Hi, I'm u/TorahBot</h1>
                <p>Please report any feedback/issues on <a
                        href="https://github.com/orenfromberg/sefaria-reddit-torahbot-docker/issues">GitHub</a>.</p>
                <hr />
                <h2>References</h2>
                <!-- <p>Here you can explore the various titles on Sefaria that u/TorahBot can fetch references for.</p> -->
                <p>Start typing the name of the title you would like to reference, and explore what Sefaria texts
                    u/TorahBot can fetch.</p>
                <div class="autocomplete" style="width:300px;">
                    <input id="myInput" type="text" name="myCountry" placeholder="e.g. Genesis">
                </div>
                <span>
                    <button class="btn btn-primary" id="copyButton" onclick="copy_title()">
                        <!-- <span class="tooltiptext" id="myTooltip">Copy to clipboard</span> -->
                        Copy text
                    </button>
                </span>
                <hr />
                <h2>Support My Work!</h2>
                <p>My passion is supercharging Jewish education with technology.</p>
                <p>Please consider supporting my work.</p>
                <p>Any donations will go towards hosting TorahBot, maintaining the codebase, and building new features.
                </p>
                <p>Thank you!</p>
                <style>
                    * {
                        box-sizing: border-box;
                    }

                    body {
                        font: 16px Arial;
                    }

                    .autocomplete {
                        /*the container must be positioned relative:*/
                        position: relative;
                        display: inline-block;
                    }

                    input {
                        border: 1px solid transparent;
                        background-color: #f1f1f1;
                        padding: 10px;
                        font-size: 16px;
                    }

                    input[type=text] {
                        background-color: #f1f1f1;
                        width: 100%;
                    }

                    input[type=submit] {
                        background-color: DodgerBlue;
                        color: #fff;
                    }

                    .autocomplete-items {
                        position: absolute;
                        border: 1px solid #d4d4d4;
                        border-bottom: none;
                        border-top: none;
                        z-index: 99;
                        /*position the autocomplete items to be the same width as the container:*/
                        top: 100%;
                        left: 0;
                        right: 0;
                    }

                    .autocomplete-items div {
                        padding: 10px;
                        cursor: pointer;
                        background-color: #fff;
                        border-bottom: 1px solid #d4d4d4;
                    }

                    .autocomplete-items div:hover {
                        /*when hovering an item:*/
                        background-color: #e9e9e9;
                    }

                    .autocomplete-active {
                        /*when navigating through the items using the arrow keys:*/
                        background-color: DodgerBlue !important;
                        color: #ffffff;
                    }

                    .btcpay-form {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                    }

                    .btcpay-form--inline {
                        flex-direction: row;
                    }

                    .btcpay-form--block {
                        flex-direction: column;
                    }

                    .btcpay-form--inline .submit {
                        margin-left: 15px;
                    }

                    .btcpay-form--block select {
                        margin-bottom: 10px;
                    }

                    .btcpay-form .btcpay-custom-container {
                        text-align: center;
                    }

                    .btcpay-custom {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    }

                    .btcpay-form .plus-minus {
                        cursor: pointer;
                        font-size: 25px;
                        line-height: 25px;
                        background: #DFE0E1;
                        height: 30px;
                        width: 45px;
                        border: none;
                        border-radius: 60px;
                        margin: auto 5px;
                        display: inline-flex;
                        justify-content: center;
                    }

                    .btcpay-form select {
                        -moz-appearance: none;
                        -webkit-appearance: none;
                        appearance: none;
                        color: currentColor;
                        background: transparent;
                        border: 1px solid transparent;
                        display: block;
                        padding: 1px;
                        margin-left: auto;
                        margin-right: auto;
                        font-size: 11px;
                        cursor: pointer;
                    }

                    .btcpay-form select:hover {
                        border-color: #ccc;
                    }

                    .btcpay-form option {
                        color: #000;
                        background: rgba(0, 0, 0, .1);
                    }

                    .btcpay-input-price {
                        -moz-appearance: textfield;
                        border: none;
                        box-shadow: none;
                        text-align: center;
                        font-size: 25px;
                        margin: auto;
                        border-radius: 5px;
                        line-height: 35px;
                        background: #fff;
                    }

                    .btcpay-input-price::-webkit-outer-spin-button,
                    .btcpay-input-price::-webkit-inner-spin-button {
                        -webkit-appearance: none;
                        margin: 0;
                    }
                </style>
                <style>
                    input[type=range].btcpay-input-range {
                        -webkit-appearance: none;
                        width: 100%;
                        background: transparent;
                    }

                    input[type=range].btcpay-input-range:focus {
                        outline: 0;
                    }

                    input[type=range].btcpay-input-range::-webkit-slider-runnable-track {
                        width: 100%;
                        height: 3.1px;
                        cursor: pointer;
                        box-shadow: 0 0 1.7px #020, 0 0 0 #003c00;
                        background: #f3f3f3;
                        border-radius: 1px;
                        border: 0;
                    }

                    input[type=range].btcpay-input-range::-webkit-slider-thumb {
                        box-shadow: none;
                        border: 2.5px solid #cedc21;
                        height: 22px;
                        width: 22px;
                        border-radius: 50%;
                        background: #0f3723;
                        cursor: pointer;
                        -webkit-appearance: none;
                        margin-top: -9.45px
                    }

                    input[type=range].btcpay-input-range:focus::-webkit-slider-runnable-track {
                        background: #fff;
                    }

                    input[type=range].btcpay-input-range::-moz-range-track {
                        width: 100%;
                        height: 3.1px;
                        cursor: pointer;
                        box-shadow: 0 0 1.7px #020, 0 0 0 #003c00;
                        background: #f3f3f3;
                        border-radius: 1px;
                        border: 0;
                    }

                    input[type=range].btcpay-input-range::-moz-range-thumb {
                        box-shadow: none;
                        border: 2.5px solid #cedc21;
                        height: 22px;
                        width: 22px;
                        border-radius: 50%;
                        background: #0f3723;
                        cursor: pointer;
                    }

                    input[type=range].btcpay-input-range::-ms-track {
                        width: 100%;
                        height: 3.1px;
                        cursor: pointer;
                        background: 0 0;
                        border-color: transparent;
                        color: transparent;
                    }

                    input[type=range].btcpay-input-range::-ms-fill-lower {
                        background: #e6e6e6;
                        border: 0;
                        border-radius: 2px;
                        box-shadow: 0 0 1.7px #020, 0 0 0 #003c00;
                    }

                    input[type=range].btcpay-input-range::-ms-fill-upper {
                        background: #f3f3f3;
                        border: 0;
                        border-radius: 2px;
                        box-shadow: 0 0 1.7px #020, 0 0 0 #003c00;
                    }

                    input[type=range].btcpay-input-range::-ms-thumb {
                        box-shadow: none;
                        border: 2.5px solid #cedc21;
                        height: 22px;
                        width: 22px;
                        border-radius: 50%;
                        background: #0f3723;
                        cursor: pointer;
                        height: 3.1px;
                    }

                    input[type=range].btcpay-input-range:focus::-ms-fill-lower {
                        background: #f3f3f3;
                    }

                    input[type=range].btcpay-input-range:focus::-ms-fill-upper {
                        background: #fff;
                    }
                </style>
                <form method="POST" action="https://btcpay.satoshislist.club/api/v1/invoices"
                    class="btcpay-form btcpay-form--block">
                    <input type="hidden" name="storeId" value="CT3XChJkKCjidvxoQkP9pHCcD2Qud1ybR6sLStT2Rwcd" />
                    <input type="hidden" name="browserRedirect"
                        value="https://orenfromberg.github.io/sefaria-reddit-torahbot-docker/thanks.html" />
                    <input type="hidden" name="notifyEmail" value="orenfromberg@gmail.com" />
                    <div class="btcpay-custom-container">
                        <input class="btcpay-input-price" type="number" name="price" min="1" max="180" step="1"
                            value="1" data-price="1" style="width:209px;" oninput="handlePriceInput(event);return false"
                            onchange="handleSliderChange(event);return false" />
                        <select name="currency">
                            <option value="USD" selected>USD</option>
                            <option value="GBP">GBP</option>
                            <option value="EUR">EUR</option>
                            <option value="BTC">BTC</option>
                        </select>
                        <input type="range" class="btcpay-input-range" min="1" max="180" step="1" value="1"
                            style="width:209px;margin-bottom:15px;" oninput="handleSliderInput(event);return false" />
                    </div>
                    <input type="image" class="submit" name="submit"
                        src="https://btcpay.satoshislist.club/img/paybutton/pay.svg" style="width:209px"
                        alt="Pay with BTCPay Server, a Self-Hosted Bitcoin Payment Processor">
                </form>
                <script>
                    function copy_title() {
                        var copyText = document.getElementById("myInput");
                        copyText.select();
                        copyText.setSelectionRange(0, 99999);
                        navigator.clipboard.writeText(copyText.value);

                        var button = document.getElementById("copyButton")
                        button.innerHTML = "Copied!"
                        setTimeout(function() {
                            button.innerHTML = "Copy text"
                        }, 1000)
                    }
                    function autocomplete(inp, arr) {
                        /*the autocomplete function takes two arguments,
                        the text field element and an array of possible autocompleted values:*/
                        var currentFocus;
                        /*execute a function when someone writes in the text field:*/
                        inp.addEventListener("input", function (e) {
                            var a, b, i, val = this.value;
                            /*close any already open lists of autocompleted values*/
                            closeAllLists();
                            if (!val) { return false; }
                            currentFocus = -1;
                            /*create a DIV element that will contain the items (values):*/
                            a = document.createElement("DIV");
                            a.setAttribute("id", this.id + "autocomplete-list");
                            a.setAttribute("class", "autocomplete-items");
                            /*append the DIV element as a child of the autocomplete container:*/
                            this.parentNode.appendChild(a);
                            var resultCount = 0
                            /*for each item in the array...*/
                            for (i = 0; i < arr.length; i++) {
                                /*check if the item starts with the same letters as the text field value:*/
                                if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
                                    /*create a DIV element for each matching element:*/
                                    b = document.createElement("DIV");
                                    /*make the matching letters bold:*/
                                    b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
                                    b.innerHTML += arr[i].substr(val.length);
                                    /*insert a input field that will hold the current array item's value:*/
                                    b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
                                    /*execute a function when someone clicks on the item value (DIV element):*/
                                    b.addEventListener("click", function (e) {
                                        /*insert the value for the autocomplete text field:*/
                                        inp.value = this.getElementsByTagName("input")[0].value;
                                        /*close the list of autocompleted values,
                                        (or any other open lists of autocompleted values:*/
                                        closeAllLists();
                                    });
                                    a.appendChild(b);
                                    resultCount++
                                }
                                /* limit the number of results to 10 for good performance */
                                if(resultCount==10) {
                                    break
                                }
                            }
                        });
                        /*execute a function presses a key on the keyboard:*/
                        inp.addEventListener("keydown", function (e) {
                            var x = document.getElementById(this.id + "autocomplete-list");
                            if (x) x = x.getElementsByTagName("div");
                            if (e.keyCode == 40) {
                                /*If the arrow DOWN key is pressed,
                                increase the currentFocus variable:*/
                                currentFocus++;
                                /*and and make the current item more visible:*/
                                addActive(x);
                            } else if (e.keyCode == 38) { //up
                                /*If the arrow UP key is pressed,
                                decrease the currentFocus variable:*/
                                currentFocus--;
                                /*and and make the current item more visible:*/
                                addActive(x);
                            } else if (e.keyCode == 13) {
                                /*If the ENTER key is pressed, prevent the form from being submitted,*/
                                e.preventDefault();
                                if (currentFocus > -1) {
                                    /*and simulate a click on the "active" item:*/
                                    if (x) x[currentFocus].click();
                                }
                            }
                        });
                        function addActive(x) {
                            /*a function to classify an item as "active":*/
                            if (!x) return false;
                            /*start by removing the "active" class on all items:*/
                            removeActive(x);
                            if (currentFocus >= x.length) currentFocus = 0;
                            if (currentFocus < 0) currentFocus = (x.length - 1);
                            /*add class "autocomplete-active":*/
                            x[currentFocus].classList.add("autocomplete-active");
                        }
                        function removeActive(x) {
                            /*a function to remove the "active" class from all autocomplete items:*/
                            for (var i = 0; i < x.length; i++) {
                                x[i].classList.remove("autocomplete-active");
                            }
                        }
                        function closeAllLists(elmnt) {
                            /*close all autocomplete lists in the document,
                            except the one passed as an argument:*/
                            var x = document.getElementsByClassName("autocomplete-items");
                            for (var i = 0; i < x.length; i++) {
                                if (elmnt != x[i] && elmnt != inp) {
                                    x[i].parentNode.removeChild(x[i]);
                                }
                            }
                        }
                        /*execute a function when someone clicks in the document:*/
                        document.addEventListener("click", function (e) {
                            closeAllLists(e.target);
                        });
                    }
                    function handleSliderChange(event) {
                        event.preventDefault();
                        const root = event.target.closest('.btcpay-form');
                        const el = root.querySelector('.btcpay-input-price');
                        const price = parseInt(el.value);
                        const min = parseInt(event.target.getAttribute('min')) || 1;
                        const max = parseInt(event.target.getAttribute('max'));
                        if (price < min) {
                            el.value = min;
                        } else if (price > max) {
                            el.value = max;
                        }
                        root.querySelector('.btcpay-input-range').value = el.value;
                    }

                    function handleSliderInput(event) {
                        event.target.closest('.btcpay-form').querySelector('.btcpay-input-price').value = event.target.value;
                    }

                    function handlePriceInput(event) {
                        event.preventDefault();
                        const root = event.target.closest('.btcpay-form');
                        const price = parseInt(event.target.dataset.price);
                        if (isNaN(event.target.value)) root.querySelector('.btcpay-input-price').value = price;
                        const min = parseInt(event.target.getAttribute('min')) || 1;
                        const max = parseInt(event.target.getAttribute('max'));
                        if (event.target.value < min) {
                            event.target.value = min;
                        } else if (event.target.value > max) {
                            event.target.value = max;
                        }
                    }
                </script>
                <script type="text/javascript">
                    fetch('titles.json')
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            autocomplete(document.getElementById("myInput"), data);
                        })
                        .catch(function (err) {
                            console.log('error: ' + err);
                        });
                </script>
            </div>
            <div class="col"></div>
        </div>
    </div>
</body>

</html>